---
title: æœ´ç´ è´å¶æ–¯
comments: false
---

## è´å¶æ–¯ç†è®º

ç»™å®šä¸€ä¸ªå‡è®¾Hypothesis, Hå’Œè¯æ®Evidence, E. é‚£ä¹ˆåœ¨å‡ºçŽ°äº†è¯æ®Eçš„æƒ…å†µä¸‹, Hçš„æ¦‚çŽ‡ä¸º$P(H|E)=\frac{P(E|H)P(H)}{P(E)}$. 

å¦‚ç»™å‡ºä¸€æ†èŠ±ðŸŒ·, ðŸŒ¹, ðŸŒ¸çš„ä¸€äº›ç‰¹å¾å³è¯æ®E, å¦‚é¢œè‰², èŒŽé•¿. æŽ¨æµ‹å‡è®¾Hæ˜¯ä¸€æœµçŽ«ç‘°ðŸŒ¹çš„å¯èƒ½æ€§:

- $P(H|E)$: åŽéªŒæ¦‚çŽ‡, åˆå«ä½œæ¡ä»¶æ¦‚çŽ‡, æ˜¯æˆ‘ä»¬çŸ¥é“è¯æ®åŽæŸä¸€äº‹ä»¶çš„å¯èƒ½æ€§, å¦‚ç»™å‡ºé¢œè‰², èŒŽé•¿åŽ, æ˜¯çŽ«ç‘°çš„æ¦‚çŽ‡
- $P(H)$: å…ˆéªŒæ¦‚çŽ‡, æ˜¯æˆ‘ä»¬çŸ¥é“è¯æ®å‰æŸä¸€äº‹ä»¶çš„å¯èƒ½æ€§, å¦‚ä¸ç»™å‡ºä»»ä½•é¢œè‰², èŒŽé•¿, æ˜¯çŽ«ç‘°çš„æ¦‚çŽ‡
- $P(E|H)$: åŽéªŒæ¦‚çŽ‡, åˆå«ä½œæ¡ä»¶æ¦‚çŽ‡, æ˜¯æˆ‘ä»¬çŸ¥é“è¯æ®åŽæŸä¸€äº‹ä»¶çš„å¯èƒ½æ€§, å¦‚çŽ«ç‘°ä¹‹åŽ, æ˜¯çº¢è‰², é•¿èŒŽçš„æ¦‚çŽ‡
- $P(E)$: å…ˆéªŒæ¦‚çŽ‡, æ˜¯æˆ‘ä»¬çŸ¥é“è¯æ®å‰æŸä¸€äº‹ä»¶çš„å¯èƒ½æ€§, å¦‚ä¸ç»™å‡ºæ˜¯ä¸æ˜¯çŽ«ç‘°, æ˜¯çº¢è‰², é•¿èŒŽçš„æ¦‚çŽ‡ 

## æœ´ç´ è´å¶æ–¯ç®—æ³• {#nb-algorithm}

æœ´ç´ è´å¶æ–¯ç®—æ³•ç”¨äºŽè§£å†³åˆ†ç±»é—®é¢˜, ä¾èµ–çš„æ˜¯è´å¶æ–¯ç†è®º, åœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿˜åŒ…å«äº†ä¸¤å±‚å‡è®¾:

1. ç‹¬ç«‹æ€§: åœ¨çŸ¥é“æ‰€å±žç±»çš„æƒ…å†µä¸‹, æ‰€æœ‰çš„å±žæ€§(ç‰¹å¾)ä¸¤ä¸¤ä¹‹é—´éƒ½æ˜¯ç‹¬ç«‹çš„, å³å‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªå±žæ€§Aå’ŒB, ä»–ä»¬ç”¨äºŽé¢„æµ‹æŸä¸ªç±»åˆ«C, å¦‚æžœå±žæ€§Aå’Œå±žæ€§Bæ˜¯ç‹¬ç«‹çš„, é‚£ä¹ˆåœ¨ç»™å®šç±»åˆ«Cçš„æƒ…å†µä¸‹, å±žæ€§Açš„å–å€¼ä¸ä¼šå½±å“å±žæ€§Bçš„å–å€¼. å³$P(A,B|C)=P(A|C)\times P(B|C)$
2. åŒç­‰é‡è¦: æ‰€æœ‰çš„å±žæ€§éƒ½æ˜¯åŒç­‰é‡è¦çš„

ä»Žè¿™é‡Œ, æˆ‘ä»¬å¯ä»¥çœ‹å‡º, æœ´ç´ è´å¶æ–¯ç®—æ³•ä¹‹æ‰€ä»¥è¢«ç§°ä¸º"æœ´ç´ ", æˆ–è€…"å¤©çœŸ", æ˜¯å› ä¸ºå®ƒçš„å‡è®¾åŸºæœ¬ä¸Šéƒ½æ˜¯å¤©çœŸçš„, ä¸å®žé™…çš„, ä½†æ˜¯è¿™äº›å‡è®¾èƒ½å¤Ÿä½¿ç®—æ³•æ›´åŠ ç®€å•, å¹¶ä¸”å¾€å¾€èƒ½å¤Ÿå–å¾—è¾ƒå¥½çš„ç»“æžœ.

å‡è®¾æˆ‘ä»¬æœ‰ä¸€äº›å¤©æ°”æ•°æ®, ä»Žè¿™äº›æ•°æ®(è¯æ®)ä¸­æŽ¨å¯¼å‡ºå‡è®¾"èƒ½çŽ©æ¸¸æˆ"è¿˜æ˜¯"ä¸èƒ½çŽ©æ¸¸æˆ":

| outlook  | temp. | humidity | windy | play |
|----------|-------|----------|-------|------|
| sunny    | hot   | high     | false | no   |
| sunny    | hot   | high     | true  | no   |
| overcast | hot   | high     | false | yes  |
| rainy    | mild  | high     | false | yes  |
| rainy    | cool  | normal   | false | yes  |
| rainy    | cool  | normal   | true  | no   |
| overcast | cool  | normal   | true  | yes  |
| sunny    | mild  | high     | false | no   |
| sunny    | cool  | normal   | false | yes  |
| rainy    | mild  | normal   | false | yes  |
| sunny    | mild  | normal   | true  | yes  |
| overcast | mild  | high     | true  | yes  |
| overcast | hot   | normal   | false | yes  |
| rainy    | mild  | high     | true  | no   |

é¦–å…ˆ, éœ€è¦è®¡ç®—åœ¨å·²çŸ¥ç‰¹å¾çš„æƒ…å†µä¸‹, å‡è®¾æ–°çš„ä¸€å¤©çš„å¤©æ°”ä¸ºsunny, cool, high, true, åˆ†åˆ«å¯¹åº”$E_1, E_2, E_3, E_4$, å¯¹äºŽæ¯ä¸€ä¸ªç±»(å‡è®¾)éƒ½è¦è®¡ç®—ä»–ä»¬çš„åŽéªŒæ¦‚çŽ‡, å¦‚åœ¨è¿™ä¸ªä¾‹å­ä¸­, æ˜¯$P(yes|E)$å’Œ$P(no|E)$. æ ¹æ®è´å¶æ–¯ç†è®º, $P(yes|E)=\frac{P(E|yes)P(yes)}{P(E)}, P(no|E)=\frac{P(E|no)P(no)}{P(E)}$. é‚£ä¹ˆ, æˆ‘ä»¬å¦‚ä½•è®¡ç®—$P(E|yes)$å’Œ$P(E|no)$å‘¢? è¿™é‡Œ, æˆ‘ä»¬å°±ç”¨åˆ°äº†å‡è®¾1, å³$P(E|yes)=P(E_1|yes)P(E_2|yes)P(E_3|yes)P(E_4|yes)$, $P(E|no)=P(E_1|no)P(E_2|no)P(E_3|no)P(E_4|no)$. ä»£å…¥ä¸Šé¢çš„å¼å­, å¯ä»¥å¾—åˆ°$P(yes|E)=\frac{P(E_1|yes)P(E_2|yes)P(E_3|yes)P(E_4|yes)P(yes)}{P(E)}, P(no|E)=\frac{P(E_1|no)P(E_2|no)P(E_3|no)P(E_4|no)P(no)}{P(E)}$. åˆ†å­çš„éƒ¨åˆ†å¯ä»¥ç›´æŽ¥ä»Žè®­ç»ƒæ•°æ®ä¸­å¾—åˆ°, åˆ†æ¯çš„éƒ¨åˆ†éƒ½æ˜¯$P(E)$, ç”±äºŽæˆ‘ä»¬åªæ˜¯è¦æ¯”è¾ƒ$P(yes|E)$å’Œ$P(no|E)$, æ‰€ä»¥æ²¡æœ‰å¿…è¦ç®—å‡ºåˆ†æ¯, å…·ä½“çš„è®¡ç®—è¿‡ç¨‹å°±ä¸åœ¨è¿™é‡Œå†™äº†, å¾—åˆ°çš„ç»“æžœæ˜¯$P(yes|E)=\frac{0.0053}{P(E)}, P(no|E)=\frac{0.0206}{P(E)}$. ç”±äºŽ$P(no|E)>P(yes|E)$, æ‰€ä»¥æœ´ç´ è´å¶æ–¯é¢„æµ‹çš„sunny, cool, high, trueçš„playé€‰é¡¹ä¸ºno.

å¦ä¸€ä¸ªä¾‹å­è§[å›¾](https://img.ricolxwz.io/df558f7e1e5c65c1e36402b2b41bfa7e.png).

### é›¶é¢‘é—®é¢˜ {#zero-frequency}

åœ¨ä¸Šè¿°åˆ†ç±»é—®é¢˜ä¸­, å¯¹äºŽä¸€ä¸ªå±žæ€§å€¼(ç‰¹å¾å€¼)è‡³å°‘åœ¨æ¯ä¸€ä¸ªç±»åˆ«(play=yes, play=no)ä¸­éƒ½å‡ºçŽ°è¿‡ä¸€æ¬¡. å¦‚æžœsunnyåªå‡ºçŽ°åœ¨play=noä¸­, ä»Žæœªå‡ºçŽ°åœ¨play=yesä¸­, é‚£ä¹ˆ, å°±ä¼šæœ‰$P(yes|E)=\frac{P(E_1|yes)P(E_2|yes)P(E_3|yes)P(E_4|yes)P(yes)}{P(E)}=0$, å› ä¸º$P(E_1|yes)=0$. è¿™æ„å‘³ç€ä»»ä½•å«æœ‰å±žæ€§å€¼ä¸ºsunnyçš„å¤©æ°”æƒ…å†µéƒ½ä¼šè¢«å½’ç±»åˆ°play=no, å®Œå…¨å¿½ç•¥å…¶ä»–å€¼çš„å½±å“. 

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜, éœ€è¦ç”¨åˆ°æ‹‰æ™®æ‹‰æ–¯å¹³æ»‘æŠ€æœ¯: åœ¨è®¡ç®—$P(E_i|yes)$çš„æ—¶å€™, ç”¨åˆ°ä»¥ä¸‹å…¬å¼, $P(E_i|yes)=(count(E_i)+1)/(count(yes)+m)$, å¯¹äºŽ$P(E_i|no)$ä¹Ÿæ˜¯åŒæ ·çš„, å…¶ä¸­$m$ä¸ºè¯¥å±žæ€§$E_i$å¯èƒ½å–å€¼çš„æ•°é‡, å¦‚å¯¹äºŽoutlook, å¯èƒ½çš„å–å€¼æœ‰$3$ç§, å½“é›¶é¢‘çš„æ—¶å€™, $count(E_i)$ç­‰äºŽ$0$.

### ç¼ºå¤±å€¼é—®é¢˜ {#missing-values}

ä¸¤ç§æƒ…å†µ, æ–°æ ·æœ¬ä¸­æŸäº›å±žæ€§ç¼ºå¤±, ä¸è¦åœ¨è®¡ç®—p(E|yes)**å’Œ**è®¡ç®—p(E|no)çš„æ—¶å€™åŒ…æ‹¬é‚£ä¸ªç¼ºå¤±å€¼çš„å±žæ€§, å¦‚æ²¡æœ‰outlookåˆ™ä¸è¦åŒ…å«$p(outlook|yes)$å’Œ$p(outlook|no)$; è¡¨ä¸­çš„æŸäº›å±žæ€§å€¼ç¼ºå¤±, åˆ™ä¸è¦å°†ç¼ºå¤±å€¼çº³å…¥è®¡æ•°, å¦‚åœ¨yesä¸‹, outlookåˆ—ä¸­æœ‰ä¸€ä¸ªç¼ºå¤±å€¼, åˆ™ç›´æŽ¥è·³è¿‡, ä¸ç”¨ç®¡. 

### æ•°å€¼å±žæ€§æœ´ç´ è´å¶æ–¯ {#numeric-nb}

çŽ°åœ¨, è¯•æƒ³å¦‚æžœæ¸©åº¦å’Œæ¹¿åº¦æ˜¯æ•°å€¼çš„è¯, å¦‚ä½•å¯¹playçš„ç»“æžœåšå‡ºåˆ†ç±»å‘¢? 

å³æˆ‘ä»¬å¦‚ä½•è®¡ç®—$P(E_1|yes)$, $P(E_2|yes)$, $P(E_1|no)$, ...? æˆ‘ä»¬å‡è®¾æ•°å€¼ç¬¦åˆæ­£æ€åˆ†å¸ƒæˆ–è€…é«˜æ–¯åˆ†å¸ƒ, ä»¥æ­£æ€åˆ†å¸ƒä¸ºä¾‹, ä½¿ç”¨æ¦‚çŽ‡å‡½æ•°, å‚æ•°ä¸ºæœŸæœ›$\mu$å’Œæ ‡å‡†å·®, standard deviation $\sigma$: $f(x)=\frac{1}{\sigma\sqrt{2\pi}}e^{-\frac{(x-\mu)^2}{2\sigma^2}}$. å…¶ä¸­æœŸæœ›$\mu=\frac{\sum_{i=1}^n x_i}{n}$, æ ‡å‡†å·®$\sigma=\sqrt{\frac{\sum_{i=1}^n(x_i-\mu)^2}{n-1}}$.

ä»¥å±žæ€§æ¸©åº¦ä¸ºä¾‹, æ¸©åº¦æ˜¯ä¸€ä¸ªè¿žç»­çš„å€¼, æˆ‘ä»¬å¯ä»¥å°†æŸä¸€ä¸ªæ¸©åº¦çš„æ¦‚çŽ‡å¯†åº¦ä½œä¸ºä¹˜å­. å¦‚$f(temp=66|yes)=\frac{1}{6.2\sqrt{2\pi}}e^{-\frac{(66-73)^2}{2\times 6.2^2}}$, å…¶ä¸­$\mu=73$, è¡¨ç¤ºæ°”æ¸©åœ¨åˆ†ç±»ä¸ºyesä¸‹çš„æœŸæœ›(å‡å€¼), $\sigma=6.2$, è¡¨ç¤ºæ°”æ¸©åœ¨åˆ†ç±»ä¸ºyesä¸‹çš„æ ‡å‡†å·®.

å…¶ä»–ç±»ä¼¼, æœ‰äº†è¿™äº›å€¼, å°±å¯ä»¥è®¡ç®—$P(yes|E)=\frac{\frac{2}{9}\times 0.034\times 0.0221\times \frac{3}{9}\times\frac{9}{14}}{P(E)}=\frac{0.000036}{P(E)}$, $P(no|E)=\frac{\frac{3}{5}\times 0.0279\times 0.038\times \frac{3}{5}\times\frac{5}{14}}{P(E)}=\frac{0.000137}{P(E)}$, å¾—åˆ°$P(no|E)>P(yes|E)$, æ‰€ä»¥é¢„æµ‹çš„åˆ†ç±»ä¸ºplay=no.
